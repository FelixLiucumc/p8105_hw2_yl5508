---
title: "p8105_hw2_yl5508"
author: "Yifei LIU"
date: 2023/9/30
output: github_document
---

It's a proj for HW2 about DATA WRANGLING.

```{r, echo = FALSE, message = FALSE}
library(tidyverse)
```

## Problem 1

### Problem 1.1 DATA CLEANING

`pols_data` is from `pols-month.csv`. Variables are arranged by order of `year`, `month`, `president`, ... .

```{r, message = FALSE}
pols_data =
  read_csv("./datastore/pols-month.csv") |>
  janitor::clean_names() |>
  separate(mon, into = c("year", "month", "day"), "-") |>
  mutate(month = month.name[as.numeric(month)]) |>
  mutate(year_month = paste(year, month, sep = "-")) |>
  #the same as
  #mutate(month = case_match(month, case_match(month,"01"~"Jan"), ...)
  #OR using
  #mutate(month = case_when(month=="01"~"Jan"), ...)
  mutate(president = case_when(
    prez_gop != "0" ~ "gop",
    prez_dem != "0" ~ "dem"
  )) |>
  select(-c("day", "prez_gop", "prez_dem")) |>
  select(year_month, year, month, president, everything())
head(pols_data, 5)
```

`snp_data` is from `snp.csv`. Variables are arranged by order of `year`, `month`, `close`.

```{r, message = FALSE}
snp_data =
  read_csv("./datastore/snp.csv") |>
  janitor::clean_names() |>
  separate(date, into = c("month", "day", "year"), "/") |>
  mutate(year = str_replace_all((ifelse(year >= 30 & year <= 99,  paste("19", year), paste("20", year))),"[^0-9]", "")) |>
  mutate(month = month.name[as.numeric(month)]) |>
  mutate(year_month = paste(year, month, sep = "-")) |>
  select(-day) |>
  select(year_month, year, month, everything())
head(snp_data, 5)
```

`unemployment_data` is from `unemployment.csv`. Variables are arranged by order of `year`, `month`, `unemployment_rate`.

```{r, message = FALSE}
unemployment_data =
  read_csv("./datastore/unemployment.csv") |>
  janitor::clean_names() |>
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment_rate"
  ) |>
  mutate(month = month.name[match(str_to_title(month), month.abb)]) |>
  mutate(year_month = paste(year, month, sep = "-")) |>
  select(year_month, year, month, everything())
head(unemployment_data, 5)
```

### Problem 1.2 JOINING DATASETS
```{r, message = FALSE}
pols_snp = inner_join(pols_data, snp_data, by = "year_month") |>
  rename(year = year.x, month = month.x) |>
  select(year_month, year, month, president, close) |>
  arrange(year)
head(pols_snp, 5)
```

```{r, message = FALSE}
skimr::skim(pols_snp)
```

## Problem 2





