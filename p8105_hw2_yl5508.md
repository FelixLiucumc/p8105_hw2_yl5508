p8105_hw2_yl5508
================
Yifei LIU
2023/9/30

It’s a proj for HW2 about DATA WRANGLING.

## Problem 1

### Problem 1.1 DATA CLEANING

`pols_data` is from `pols-month.csv`. Variables are arranged by order of
`year-month`, `year`, `month`, `president`, … .

``` r
pols_data =
  read_csv("./datastore/pols-month.csv") |>
  janitor::clean_names() |>
  separate(mon, into = c("year", "month", "day"), "-") |>
  mutate(month = month.name[as.numeric(month)]) |>
  mutate(year_month = paste(year, month, sep = "-")) |>
  #the same as
  #mutate(month = case_match(month, case_match(month,"01"~"Jan"), ...)
  #OR using
  #mutate(month = case_when(month=="01"~"Jan"), ...)
  mutate(president = case_when(
    prez_gop != "0" ~ "gop",
    prez_dem != "0" ~ "dem"
  )) |>
  select(-c("day", "prez_gop", "prez_dem")) |>
  select(year_month, year, month, president, everything())
head(pols_data, 5)
```

    ## # A tibble: 5 × 10
    ##   year_month    year  month    president gov_gop sen_gop rep_gop gov_dem sen_dem
    ##   <chr>         <chr> <chr>    <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>
    ## 1 1947-January  1947  January  dem            23      51     253      23      45
    ## 2 1947-February 1947  February dem            23      51     253      23      45
    ## 3 1947-March    1947  March    dem            23      51     253      23      45
    ## 4 1947-April    1947  April    dem            23      51     253      23      45
    ## 5 1947-May      1947  May      dem            23      51     253      23      45
    ## # ℹ 1 more variable: rep_dem <dbl>

`snp_data` is from `snp.csv`. Variables are arranged by order of
`year-month`, `year`, `month`, `close`.

``` r
snp_data =
  read_csv("./datastore/snp.csv") |>
  janitor::clean_names() |>
  separate(date, into = c("month", "day", "year"), "/") |>
  mutate(year = str_replace_all((ifelse(year >= 30 & year <= 99,  paste("19", year), paste("20", year))),"[^0-9]", "")) |>
  mutate(month = month.name[as.numeric(month)]) |>
  mutate(year_month = paste(year, month, sep = "-")) |>
  select(-day) |>
  select(year_month, year, month, everything())
head(snp_data, 5)
```

    ## # A tibble: 5 × 4
    ##   year_month year  month close
    ##   <chr>      <chr> <chr> <dbl>
    ## 1 2015-July  2015  July  2080.
    ## 2 2015-June  2015  June  2063.
    ## 3 2015-May   2015  May   2107.
    ## 4 2015-April 2015  April 2086.
    ## 5 2015-March 2015  March 2068.

`unemployment_data` is from `unemployment.csv`. Variables are arranged
by order of `year-month`, `year`, `month`, `unemployment_rate`.

``` r
unemployment_data =
  read_csv("./datastore/unemployment.csv") |>
  janitor::clean_names() |>
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment_rate"
  ) |>
  mutate(month = month.name[match(str_to_title(month), month.abb)]) |>
  mutate(year_month = paste(year, month, sep = "-")) |>
  select(year_month, year, month, everything())
head(unemployment_data, 5)
```

    ## # A tibble: 5 × 4
    ##   year_month     year month    unemployment_rate
    ##   <chr>         <dbl> <chr>                <dbl>
    ## 1 1948-January   1948 January                3.4
    ## 2 1948-February  1948 February               3.8
    ## 3 1948-March     1948 March                  4  
    ## 4 1948-April     1948 April                  3.9
    ## 5 1948-May       1948 May                    3.5

### Problem 1.2 JOINING DATASETS

``` r
pols_snp = inner_join(pols_data, snp_data, by = "year_month") |>
  rename(year = year.x, month = month.x) |>
  select(year_month, year, month, president, close) |>
  arrange(year)
head(pols_snp, 5)
```

    ## # A tibble: 5 × 5
    ##   year_month    year  month    president close
    ##   <chr>         <chr> <chr>    <chr>     <dbl>
    ## 1 1950-January  1950  January  dem        17.0
    ## 2 1950-February 1950  February dem        17.2
    ## 3 1950-March    1950  March    dem        17.3
    ## 4 1950-April    1950  April    dem        18.0
    ## 5 1950-May      1950  May      dem        18.8

``` r
skimr::skim(pols_snp)
```

|                                                  |          |
|:-------------------------------------------------|:---------|
| Name                                             | pols_snp |
| Number of rows                                   | 786      |
| Number of columns                                | 5        |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_   |          |
| Column type frequency:                           |          |
| character                                        | 4        |
| numeric                                          | 1        |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ |          |
| Group variables                                  | None     |

Data summary

**Variable type: character**

| skim_variable | n_missing | complete_rate | min | max | empty | n_unique | whitespace |
|:--------------|----------:|--------------:|----:|----:|------:|---------:|-----------:|
| year_month    |         0 |             1 |   8 |  14 |     0 |      786 |          0 |
| year          |         0 |             1 |   4 |   4 |     0 |       66 |          0 |
| month         |         0 |             1 |   3 |   9 |     0 |       12 |          0 |
| president     |         0 |             1 |   3 |   3 |     0 |        2 |          0 |

**Variable type: numeric**

| skim_variable | n_missing | complete_rate |   mean |     sd |    p0 |   p25 |    p50 |    p75 |    p100 | hist  |
|:--------------|----------:|--------------:|-------:|-------:|------:|------:|-------:|-------:|--------:|:------|
| close         |         0 |             1 | 472.85 | 543.29 | 17.05 | 83.67 | 137.26 | 932.06 | 2107.39 | ▇▁▂▁▁ |

## Problem 2

### Problem 2.1 DATA CLEANING

``` r
mrt_data =
  read_excel("./datastore/202207 Trash Wheel Collection Data.xlsx", sheet = 1, range = "A2:N549") |>
  janitor::clean_names() |>
  separate(date, into=c("y", "m", "day"), sep = "-") |>
  select(-y, -m) |>
  mutate(year = as.character(year)) |>
  mutate(homes_powered = weight_tons*500/30) |>
  mutate(sourcename = "Mr. Trash Wheel") |>
  select(sourcename, year, month, day, homes_powered, weight_tons, volume_cubic_yards, plastic_bottles, polystyrene, cigarette_butts)
head(mrt_data, 5)
```

    ## # A tibble: 5 × 10
    ##   sourcename      year  month day   homes_powered weight_tons volume_cubic_yards
    ##   <chr>           <chr> <chr> <chr>         <dbl>       <dbl>              <dbl>
    ## 1 Mr. Trash Wheel 2014  May   16             71.8        4.31                 18
    ## 2 Mr. Trash Wheel 2014  May   16             45.7        2.74                 13
    ## 3 Mr. Trash Wheel 2014  May   16             57.5        3.45                 15
    ## 4 Mr. Trash Wheel 2014  May   17             51.7        3.1                  15
    ## 5 Mr. Trash Wheel 2014  May   17             67.7        4.06                 18
    ## # ℹ 3 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>

``` r
pro_data =
  read_excel("./datastore/202207 Trash Wheel Collection Data.xlsx", sheet = 2, range = "A2:M96") |>
  janitor::clean_names() |>
  separate(date, into=c("y", "m", "day"), sep = "-") |>
  select(-y, -m) |>
  mutate(year = as.character(year)) |>
  mutate(homes_powered = weight_tons*500/30) |>
  mutate(sourcename = "Professor Trash Wheel") |>
  select(sourcename, year, month, day, homes_powered, weight_tons, volume_cubic_yards, plastic_bottles, polystyrene, cigarette_butts)
head(pro_data, 5)
```

    ## # A tibble: 5 × 10
    ##   sourcename      year  month day   homes_powered weight_tons volume_cubic_yards
    ##   <chr>           <chr> <chr> <chr>         <dbl>       <dbl>              <dbl>
    ## 1 Professor Tras… 2017  Janu… 02             29.8        1.79                 15
    ## 2 Professor Tras… 2017  Janu… 30             26.3        1.58                 15
    ## 3 Professor Tras… 2017  Febr… 26             38.7        2.32                 18
    ## 4 Professor Tras… 2017  Febr… 26             62          3.72                 15
    ## 5 Professor Tras… 2017  Febr… 28             24.2        1.45                 15
    ## # ℹ 3 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>

``` r
gwy_data =
  read_excel("./datastore/202207 Trash Wheel Collection Data.xlsx", sheet = 4, range = "A2:K108") |>
  janitor::clean_names() |>
  separate(date, into=c("y", "m", "day"), sep = "-") |>
  select(-y, -m) |>
  mutate(year = as.character(year)) |>
  mutate(homes_powered = weight_tons*500/30) |>
  mutate(sourcename = "Gwynnda") |>
  select(sourcename, year, month, day, homes_powered, weight_tons, volume_cubic_yards, plastic_bottles, polystyrene, cigarette_butts)
head(gwy_data, 5)
```

    ## # A tibble: 5 × 10
    ##   sourcename year  month day   homes_powered weight_tons volume_cubic_yards
    ##   <chr>      <chr> <chr> <chr>         <dbl>       <dbl>              <dbl>
    ## 1 Gwynnda    2021  July  03             15.5        0.93                 15
    ## 2 Gwynnda    2021  July  07             37.7        2.26                 15
    ## 3 Gwynnda    2021  July  07             27          1.62                 15
    ## 4 Gwynnda    2021  July  16             29.3        1.76                 15
    ## 5 Gwynnda    2021  July  30             25.5        1.53                 15
    ## # ℹ 3 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>

``` r
total_data = 
  bind_rows(mrt_data, pro_data, gwy_data) |>
  arrange(year, match(month, month.name), day)
head(total_data, 5)
```

    ## # A tibble: 5 × 10
    ##   sourcename      year  month day   homes_powered weight_tons volume_cubic_yards
    ##   <chr>           <chr> <chr> <chr>         <dbl>       <dbl>              <dbl>
    ## 1 Mr. Trash Wheel 2014  May   16             71.8        4.31                 18
    ## 2 Mr. Trash Wheel 2014  May   16             45.7        2.74                 13
    ## 3 Mr. Trash Wheel 2014  May   16             57.5        3.45                 15
    ## 4 Mr. Trash Wheel 2014  May   17             51.7        3.1                  15
    ## 5 Mr. Trash Wheel 2014  May   17             67.7        4.06                 18
    ## # ℹ 3 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>

``` r
skimr::skim(total_data)
```

|                                                  |            |
|:-------------------------------------------------|:-----------|
| Name                                             | total_data |
| Number of rows                                   | 747        |
| Number of columns                                | 10         |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_   |            |
| Column type frequency:                           |            |
| character                                        | 4          |
| numeric                                          | 6          |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ |            |
| Group variables                                  | None       |

Data summary

**Variable type: character**

| skim_variable | n_missing | complete_rate | min | max | empty | n_unique | whitespace |
|:--------------|----------:|--------------:|----:|----:|------:|---------:|-----------:|
| sourcename    |         0 |             1 |   7 |  21 |     0 |        3 |          0 |
| year          |         0 |             1 |   4 |   4 |     0 |        9 |          0 |
| month         |         0 |             1 |   3 |   9 |     0 |       14 |          0 |
| day           |         0 |             1 |   2 |   2 |     0 |       31 |          0 |

**Variable type: numeric**

| skim_variable      | n_missing | complete_rate |     mean |       sd |    p0 |     p25 |     p50 |      p75 |      p100 | hist  |
|:-------------------|----------:|--------------:|---------:|---------:|------:|--------:|--------:|---------:|----------:|:------|
| homes_powered      |         0 |             1 |    50.18 |    13.77 | 10.17 |   41.42 |   51.17 |    59.50 |     93.67 | ▁▅▇▃▁ |
| weight_tons        |         0 |             1 |     3.01 |     0.83 |  0.61 |    2.49 |    3.07 |     3.57 |      5.62 | ▁▅▇▃▁ |
| volume_cubic_yards |         0 |             1 |    15.17 |     1.40 |  5.00 |   15.00 |   15.00 |    15.00 |     20.00 | ▁▁▁▇▁ |
| plastic_bottles    |         0 |             1 |  2290.85 |  1773.09 |  0.00 |  980.00 | 1930.00 |  2900.00 |   9830.00 | ▇▆▁▁▁ |
| polystyrene        |         0 |             1 |  1815.69 |  1962.61 |  0.00 |  410.00 | 1120.00 |  2625.00 |  11528.00 | ▇▂▁▁▁ |
| cigarette_butts    |         0 |             1 | 17183.95 | 26817.38 |  0.00 | 3450.00 | 6400.00 | 19000.00 | 310000.00 | ▇▁▁▁▁ |

`#` of observations in resulting dataset is 747\`. total weight
collected by Professor Trash Wheel is 190.12

1.158478^{6}

`total_data |> filter(sourcename == "Professor Trash Wheel") |> sum(weight_tons)`

`total_data |> filter(sourcename == "Professor Trash Wheel") |> sum(pull(weight_tons))`.

## Problem 3

### Problem 3.1 DATA CLEANING
